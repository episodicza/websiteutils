var epsForms=function(e){"use strict";return e.initFormValidation=function(e,t={},n=null){let o=$(document.getElementById(e));jQuery.validator.addMethod("validPhoneNumber",(function(e,t){if(e.trim()){const e=window.intlTelInputGlobals.getInstance(t);return e.isValidNumber()&&e.getNumber().length>11}return!0}),"Invalid phone number"),$("input[type='tel']",o).each((function(){let e=window.intlTelInputGlobals.getInstance(this);null!=e&&e.destroy();const t={utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@18.1.1/build/js/utils.js",initialCountry:"za",allowDropdown:!1,autoPlaceholder:"aggressive",hiddenInput:this.name+"_e164"};e=window.intlTelInput(this,t)}));let i={errorClass:"form-error",validClass:"form-valid",errorPlacement:function(e,t){t.parent().hasClass("iti")?e.insertAfter(t.parent()):e.insertAfter(t)},highlight:function(e,t,n){$(e).addClass("field-error").removeClass("field-valid")},unhighlight:function(e,t,n){$(e).addClass("field-valid").removeClass("field-error")},submitHandler:function(e){const t=$(e),o=t.find("input[type='submit']");o.prop("disabled",!0).css("cursor","progress");const i=$(".w-form-done",t.parent()),l=$(".w-form-fail",t.parent()),s={fields:Object.fromEntries(new FormData(e)),meta:{href:window.location.href,path:window.location.pathname}};fetch(t.attr("action"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((e=>{if(e.ok){if(function(e,t){const n={event:"form_submission",formId:t.attr("id"),formType:t.data("type")||"lead"};"lead"===n.formType&&(n.formProduct=e.fields.product||t.data("product")||null,n.emailAddress=e.fields.email||null,n.phoneNumber=e.fields.phone_e164||e.fields.phone||null,n.firstName=e.fields.first_name||e.fields.firstName||null,n.lastName=e.fields.last_name||e.fields.lastName||null),window.dataLayer=window.dataLayer||[],window.dataLayer.push(n)}(s,t),n)try{n(s)}catch(e){console.log(e)}const e=t.attr("redirect")||t.data("redirect")||null;e?window.location.href=e:(t.hide(),l.hide(),i.show(),$([document.documentElement,document.body]).animate({scrollTop:i.offset().top-250},300)),o.prop("disabled",!1).css("cursor","default")}else console.log(e.status,e.statusText),t.show(),l.show(),i.hide(),o.prop("disabled",!1).css("cursor","default")})).catch((e=>{console.log(e),t.show(),l.show(),i.hide(),o.prop("disabled",!1).css("cursor","default")}))}};o.validate({...i,...t})},e}({});
